<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>富贵险中求 - 骰子走步局</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <div class="hud">
        <h2 id="msg" class="instruction-text">请选择前进方向</h2>

        <div class="dir-btn-group">
            <button class="neon-btn btn-cw" onclick="setDirection(1)">
                <span>↻</span> 顺时针
            </button>
            <button class="neon-btn btn-ccw" onclick="setDirection(-1)">
                <span>↺</span> 逆时针
            </button>
        </div>

        <div class="dice-area" id="dice-area">
            <div class="dice-row">
                <div class="die-box" id="d1">?</div>
                <div class="die-box" id="d2">?</div>
                <div class="die-box" id="d3">?</div>
                <div class="die-box" id="d4">?</div>
                <div class="die-box" id="d5">?</div>
            </div>
            <button class="roll-btn" onclick="roll()">
                摇骰子 ( -¥100 )
            </button>
        </div>
    </div>

    <!-- Cells generated by JS -->
    </div>

    <button class="reveal-btn" onclick="document.getElementById('reveal-modal').style.display='flex'">? 揭秘</button>
    <button class="stats-btn" onclick="openStats()">📊 数据模拟</button>

    <!-- Modals -->
    <div id="reveal-modal" class="overlay" onclick="if(event.target===this)this.style.display='none'">
        <div class="modal results-modal" style="text-align:left; line-height:1.6;">
            <h2 style="color:#333; text-align:center;">为什么你会输？</h2>
            <p>1. <strong>概率陷阱</strong>：5颗骰子点数和服从正态分布，极大概率落在 15-20 之间。</p>
            <p>2. <strong>精心布局</strong>：无论你选顺时针还是逆时针，从起点出发 15-20 步的落点，全部被安排了低奖金或陷阱。</p>
            <p>3. <strong>幸存者偏差</strong>：1000/6000元大奖看似近在咫尺，实际因步数概率几乎无法到达。</p>
            <div style="text-align:center; margin-top:20px;">
                <button class="restart-btn"
                    onclick="document.getElementById('reveal-modal').style.display='none'">我懂了</button>
            </div>
        </div>
    </div>

    <div id="result-modal" class="overlay">
        <div class="modal results-modal">
            <div id="res-title" class="win-title">WIN!</div>
            <div id="res-val" class="amount-display">+500</div>
            <button class="restart-btn" onclick="reset()">再来一局</button>
        </div>
    </div>

    <div id="stats-modal" class="overlay" onclick="if(event.target===this)this.style.display='none'">
        <div class="modal stats-modal-content">
            <h2 style="color:var(--neon-blue);">大数据模拟器</h2>
            <div class="sim-controls">
                <select id="sim-count" class="sim-select">
                    <option value="100">100次</option>
                    <option value="1000">1000次</option>
                    <option value="5000">5000次</option>
                </select>
                <select id="sim-strategy" class="sim-select">
                    <option value="random">随机方向</option>
                    <option value="cw">全选顺时针</option>
                    <option value="ccw">全选逆时针</option>
                </select>
                <button class="restart-btn" style="font-size:0.9rem; padding: 5px 15px;"
                    onclick="runSimulation()">开始模拟</button>
            </div>

            <div id="sim-results" style="display:none; text-align:left;">
                <table class="stats-table">
                    <tr>
                        <td>总局数</td>
                        <td id="stat-count">-</td>
                    </tr>
                    <tr>
                        <td>总投入</td>
                        <td id="stat-cost">-</td>
                    </tr>
                    <tr>
                        <td>总产出</td>
                        <td id="stat-revenue">-</td>
                    </tr>
                    <tr>
                        <td>净利润</td>
                        <td id="stat-profit" class="stats-profit">-</td>
                    </tr>
                    <tr>
                        <td>回报率</td>
                        <td id="stat-roi">-</td>
                    </tr>
                </table>
                <p style="font-size:0.8rem; color:#888; margin-top:10px; text-align:center;">*模拟使用真实游戏算法 (含杀数逻辑)</p>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>

</html>